#!/bin/bash

# Set path etc.
source ~/.zshenv

# xset for bitmap font
xset +fp ~/.fonts
xset fp rehash

# Configure X environment
xrdb ~/.Xresources
urxvtd -f -o

compton --dbus &
xsetroot -cursor_name left_ptr &
xset +fp /usr/share/fonts/local/ &
wp &
panel &
kb &
dunst &
vpsnotifyc &
urxvtd -f -o &
pulseaudio &

# Run local .xenv
source ~/.xenv

sxhkd -f 60 &

bspc config border_width        3
bspc config window_gap         25
bspc config top_padding     25

bspc config focused_border_color '#2f3133'
bspc config active_border_color  '#242628'
bspc config normal_border_color  '#242628'
bspc config urgent_border_color  '#ffaf00'
bspc config presel_border_color  '#5a5c5e'

bspc config split_ratio               0.50
bspc config auto_cancel               true
bspc config borderless_monocle        true
bspc config gapless_monocle           true
bspc config focus_by_distance         true
bspc config focus_follows_pointer     false
bspc config remove_unplugged_monitors true
bspc config remove_disabled_monitors  true
bspc config initial_polarity          second_child

bspc rule -a mplayer  state=floating
bspc rule -a mplayer2 state=floating
bspc rule -a mpv      state=floating
bspc rule -a feh      state=floating

# Define more rules in ~/.xenv - for example:
# > bspc config -d 1-2 window_gap 0
# > bspc rule -a chromium desktop=1-2 border=off

# Define monitors in ~/.xenv - for example:
# > export monitors=( 'HDMI-0' 'DVI-D-0' 'DVI-I-1' )
# Note: Order is important!
# Desktops will be named 1-1, 1-2, ..., 1-6, 2-1, 2-2, ..., n-m where n means monitor and m means desktop

i=1
for m in "${monitors[@]}"; do
    if bspc query -M | grep "$m"; then
        bspc monitor "$m" -d $i-{1..6}
        let i++
    fi
done

# Define autostart applications in ~/.xenv - for example:
# > function bspwm-autostart() {
# >     chromium &
# >     steam &
# > }

bspwm-autostart
